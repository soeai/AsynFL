version: '3'

# profile_path must be define in env_file
# and it must be created before run time

services:
  soe-asynfed-client:
    container_name: soe-asynfed-client-4
    image: vtn13042000/asynfed_tensorflow_client:2.0.0
    command: python3.9 /app/training_process/client/run_client.py
    env_file:
      - .env
    # these env variable can be defined in either .env file or as below
    environment:
      - queue_url=amqp://guest:guest@13.214.37.45:5672/%2F
      - training_exchange=test-client-tensorflow-mnist
      - local_model_folder=./weights/local_weights/
      - global_model_folder=./weights/global_weights/
      - log_path=./logs/
      - x_train_path=app/training_process/client/data/mnist_data/train-images-idx3-ubyte.gz
      - y_train_path=app/training_process/client/data/mnist_data/train-labels-idx1-ubyte.gz
      - x_test_path=app/training_process/client/data/mnist_data/t10k-images-idx3-ubyte.gz
      - y_test_path=app/training_process/client/data/mnist_data/t10k-labels-idx1-ubyte.gz
      - sleeping_time=2
      - batch_size=128
      - data_size=10000
      - tracking_point=5000
    volumes: 
      - .:/app
      - ${profile_path}:/app/training_process/client/profile.json




